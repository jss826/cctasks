---
description: バージョンタグを付けて GitHub Release を作成する
argument-hint: バージョン番号（例: 1.6.0）省略時は自動インクリメント
allowed-tools: Bash, Read, Grep, Glob
---

バージョンタグを付けて GitHub Release を作成する。

## Phase 1: 準備

1. `git status` で未コミットの変更がないか確認（あればユーザーに報告して停止）
2. タグ確認（**ローカル＋リモート両方**を確認すること）:
   - `git fetch --tags` でリモートタグを同期
   - `git tag -l --sort=-v:refname` で一覧表示
3. 既存リリース確認: `gh release list` でリリースノートの有無も確認
4. バージョン番号を決定:
   - 引数ありならそれを使用（`v` prefix 付与: `1.6.0` → `v1.6.0`）
   - 引数なしなら最新タグから **変更規模に応じて** バージョンを提案:
     - 新機能あり → マイナー版+1（`v1.5.0` → `v1.6.0`）
     - バグ修正のみ → パッチ版+1（`v1.5.2` → `v1.5.3`）
   - タグが無ければ `v0.1.0` から開始
5. 前回タグからの変更一覧を `git log --oneline <前回タグ>..HEAD` で取得
6. リリースノートを生成:
   - **このリリースに含まれるコミットだけ** をノートに記載する（過去リリース分を混ぜない）
   - カテゴリ分け: New / Fixed / Changed / Other
7. バージョン番号とリリースノートをユーザーに提示

→ **承認待ち**

## Phase 2: リリース

1. タグを作成してプッシュする: `git tag <version> && git push origin <version>`
2. `gh release create <version> --title "<version>" --notes "<リリースノート>"` で GitHub Release を作成
3. `git fetch --tags` でリモートタグをローカルに同期する
4. `git tag -l <version>` でローカルにタグが存在することを確認する
5. 結果を報告（タグ名 + リリースURL + 含まれるコミット数）

## ルール

- Go プロジェクトのため `go install` 時に git タグからバージョンが自動反映される（package.json 等のバージョン更新は不要）
- 未コミットの変更がある場合は Phase 1 で停止する
- 既存タグと重複する場合はエラーで止まる
- リリースノートは日本語で書く
- リリースノートには **前回タグ〜HEAD の変更のみ** 記載する
- `gh` コマンド失敗時はエラー内容を報告して止まる（リトライしない）

## 完了条件

- [ ] GitHub Release が作成された
- [ ] ローカルタグがリモートと同期されている
- [ ] リリースURLが報告された
